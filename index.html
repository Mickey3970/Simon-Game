<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8" />
    <title>Simon</title>
    <link rel="icon" type="image/png" href="Simon_Game.png" />
    <link rel="stylesheet" href="styles.css" />
    <link
      href="https://fonts.googleapis.com/css?family=Press+Start+2P"
      rel="stylesheet"
    />
  </head>

  <body>
    <!-- Theme Selector -->
    <div class="theme-selector">
      <button class="theme-btn active" onclick="setTheme('default')">
        Default
      </button>
      <button class="theme-btn" onclick="setTheme('space-theme')">Space</button>
      <button class="theme-btn" onclick="setTheme('synthwave-theme')">
        Synthwave
      </button>
    </div>

    <h1 id="level-title">Press A Key to Start</h1>

    <div class="container">
      <div class="row">
        <div type="button" id="green" class="btn green"></div>
        <div type="button" id="red" class="btn red"></div>
      </div>

      <div class="row">
        <div type="button" id="yellow" class="btn yellow"></div>
        <div type="button" id="blue" class="btn blue"></div>
      </div>
    </div>

    <!-- Auth Modal -->
    <div id="auth-modal" class="modal-overlay">
      <div class="modal-card">
        <h2>Welcome to Simon!</h2>
        <p>Choose how you want to play</p>
        <button id="guest-auth-btn" class="modal-btn">Play as Guest</button>
        <button id="google-auth-btn" class="modal-btn google">
          Sign in with Google
        </button>
      </div>
    </div>

    <div class="scoreboard-btns">
      <button id="global-scores-btn" class="scoreboard-btn">
        Global Highscores
      </button>
    </div>

    <!-- Global Scoreboard Modal -->
    <div id="global-score-modal" class="score-modal-overlay">
      <div class="score-modal-card" id="global-score-content"></div>
    </div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

    <!-- Firebase scripts -->
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-database-compat.js"></script>
    <script>
      const firebaseConfig = {
        apiKey: "AIzaSyA6XDXBxF4emgPkiC4QQWy3Nu8b2XNkgOI",
        authDomain: "simon-game-cec07.firebaseapp.com",
        projectId: "simon-game-cec07",
        storageBucket: "simon-game-cec07.firebasestorage.app",
        messagingSenderId: "927771552176",
        appId: "1:927771552176:web:cd778559998503232a4e75",
        measurementId: "G-VC37RGDKSF",
      };
      firebase.initializeApp(firebaseConfig);
    </script>
    <script src="game.js"></script>

    <!-- Theme switching script -->
    <script>
      function setTheme(themeName) {
        // Remove all theme classes
        document.body.classList.remove("space-theme", "synthwave-theme");

        // Add the selected theme class (if not default)
        if (themeName !== "default") {
          document.body.classList.add(themeName);
        }

        // Update active button styling
        document
          .querySelectorAll(".theme-btn")
          .forEach((btn) => btn.classList.remove("active"));
        event.target.classList.add("active");

        // Save theme preference
        localStorage.setItem("selectedTheme", themeName);
      }

      // Load saved theme on page load
      window.addEventListener("load", function () {
        const savedTheme = localStorage.getItem("selectedTheme") || "default";
        setTheme(savedTheme);

        // Update the active button without triggering the event
        document.querySelectorAll(".theme-btn").forEach((btn) => {
          btn.classList.remove("active");
          if (
            (savedTheme === "default" && btn.textContent === "Default") ||
            (savedTheme === "space-theme" && btn.textContent === "Space") ||
            (savedTheme === "synthwave-theme" &&
              btn.textContent === "Synthwave")
          ) {
            btn.classList.add("active");
          }
        });
      });
    </script>
  </body>
</html>

/* TODO: Audio latency → preload Audio objects, reuse them, reset currentTime.
Highscore fetching → handle async properly, maybe pre-fetch. Login popup styling
→ hide until fully styled; you cant style Google popup but can style your
in-page choice popup. Add a Favicon. */
